<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 750" font-family="'Segoe UI', 'Helvetica Neue', Arial, sans-serif">
  <defs>
    <linearGradient id="bgGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#0f172a"/>
      <stop offset="100%" stop-color="#1e293b"/>
    </linearGradient>
    <filter id="glow">
      <feGaussianBlur stdDeviation="2.5" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <filter id="shadow">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#000" flood-opacity="0.35"/>
    </filter>
    <marker id="arrowRed" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ef4444"/>
    </marker>
    <marker id="arrowBlue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3b82f6"/>
    </marker>
    <marker id="arrowPurple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#a855f7"/>
    </marker>
    <marker id="arrowGray" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1100" height="750" fill="url(#bgGrad)" rx="12"/>

  <!-- ===== Title ===== -->
  <text x="380" y="38" text-anchor="middle" fill="#f8fafc" font-size="22" font-weight="700">Sensitive Data over HTTP — Attack Flow</text>
  <text x="380" y="58" text-anchor="middle" fill="#94a3b8" font-size="12">HTTPでの機密データ送信 — 中間者攻撃による通信傍受</text>
  <rect x="280" y="66" width="200" height="20" rx="10" fill="#ef4444" opacity="0.15"/>
  <text x="380" y="80" text-anchor="middle" fill="#fca5a5" font-size="10" font-weight="600">OWASP — Cryptographic Failures</text>

  <!-- ====================================================== -->
  <!--  INTENDED COMMUNICATION (dashed gray line above)       -->
  <!-- ====================================================== -->
  <line x1="175" y1="170" x2="635" y2="170" stroke="#64748b" stroke-width="1.8" stroke-dasharray="8,5" marker-end="url(#arrowGray)" opacity="0.5"/>
  <line x1="635" y1="178" x2="175" y2="178" stroke="#64748b" stroke-width="1.8" stroke-dasharray="8,5" marker-end="url(#arrowGray)" opacity="0.5"/>
  <rect x="300" y="152" width="210" height="20" rx="6" fill="#1e293b" stroke="#64748b" stroke-width="0.8" opacity="0.7"/>
  <text x="405" y="166" text-anchor="middle" fill="#64748b" font-size="9.5" font-weight="600">&#128274; &#215; &#26412;&#26469;&#12398;&#36890;&#20449; (&#26263;&#21495;&#21270;&#12394;&#12375;)</text>

  <!-- ====================================================== -->
  <!--  ACTORS (MITM layout: Victim LEFT, Attacker CENTER, Server RIGHT) -->
  <!-- ====================================================== -->

  <!-- Victim (Left) -->
  <g transform="translate(120, 280)" filter="url(#shadow)">
    <rect x="-56" y="-30" width="112" height="125" rx="12" fill="#1e1b2e" stroke="#a855f7" stroke-width="1.5"/>
    <g transform="translate(0, 10)">
      <circle cx="0" cy="-9" r="13" fill="none" stroke="#a855f7" stroke-width="1.8"/>
      <circle cx="-4" cy="-11" r="1.5" fill="#a855f7"/>
      <circle cx="4" cy="-11" r="1.5" fill="#a855f7"/>
      <path d="M-4,-4 Q0,1 4,-4" fill="none" stroke="#a855f7" stroke-width="1.3" stroke-linecap="round"/>
      <path d="M-17,36 Q-17,14 0,10 Q17,14 17,36" fill="none" stroke="#a855f7" stroke-width="2"/>
      <line x1="-17" y1="36" x2="17" y2="36" stroke="#a855f7" stroke-width="2" stroke-linecap="round"/>
    </g>
    <text x="0" y="72" text-anchor="middle" fill="#d8b4fe" font-size="13" font-weight="700">&#34987;&#23475;&#32773;</text>
    <text x="0" y="86" text-anchor="middle" fill="#a855f7" font-size="9.5" opacity="0.7">Victim</text>
  </g>

  <!-- Attacker / Eavesdropper (Center) -->
  <g transform="translate(390, 280)" filter="url(#shadow)">
    <rect x="-56" y="-30" width="112" height="125" rx="12" fill="#1e1b2e" stroke="#ef4444" stroke-width="1.5"/>
    <g transform="translate(0, 10)">
      <path d="M-13,-17 Q0,-28 13,-17 L13,-4 Q0,2 -13,-4 Z" fill="none" stroke="#ef4444" stroke-width="1.8"/>
      <circle cx="-4" cy="-9" r="1.8" fill="#ef4444"/>
      <circle cx="4" cy="-9" r="1.8" fill="#ef4444"/>
      <path d="M-17,36 Q-17,14 0,10 Q17,14 17,36" fill="none" stroke="#ef4444" stroke-width="2"/>
      <line x1="-17" y1="36" x2="17" y2="36" stroke="#ef4444" stroke-width="2" stroke-linecap="round"/>
    </g>
    <text x="0" y="72" text-anchor="middle" fill="#fca5a5" font-size="13" font-weight="700">&#25915;&#25731;&#32773;</text>
    <text x="0" y="86" text-anchor="middle" fill="#ef4444" font-size="9.5" opacity="0.7">&#20013;&#38291;&#32773; / Eavesdropper</text>
  </g>

  <!-- Web Server (Right) -->
  <g transform="translate(660, 280)" filter="url(#shadow)">
    <rect x="-56" y="-30" width="112" height="125" rx="12" fill="#1e1b2e" stroke="#3b82f6" stroke-width="1.5"/>
    <g transform="translate(0, 14)">
      <rect x="-20" y="-18" width="40" height="12" rx="3" fill="none" stroke="#3b82f6" stroke-width="1.5"/>
      <circle cx="-12" cy="-12" r="2" fill="#3b82f6"/><circle cx="-5" cy="-12" r="2" fill="#3b82f6"/>
      <rect x="-20" y="-2" width="40" height="12" rx="3" fill="none" stroke="#3b82f6" stroke-width="1.5"/>
      <circle cx="-12" cy="4" r="2" fill="#3b82f6"/><circle cx="-5" cy="4" r="2" fill="#3b82f6"/>
      <rect x="-20" y="14" width="40" height="12" rx="3" fill="none" stroke="#3b82f6" stroke-width="1.5"/>
      <circle cx="-12" cy="20" r="2" fill="#3b82f6"/><circle cx="-5" cy="20" r="2" fill="#3b82f6"/>
    </g>
    <text x="0" y="72" text-anchor="middle" fill="#93c5fd" font-size="13" font-weight="700">Web&#12469;&#12540;&#12496;&#12540;</text>
    <text x="0" y="86" text-anchor="middle" fill="#3b82f6" font-size="9.5" opacity="0.7">Server</text>
  </g>

  <!-- ====================================================== -->
  <!--  ARROWS (intercepted communication through attacker)   -->
  <!-- ====================================================== -->

  <!-- Step 1: Victim → Attacker (HTTP login data) -->
  <path d="M 176 260 L 330 260" fill="none" stroke="#a855f7" stroke-width="2.2" stroke-dasharray="8,4" marker-end="url(#arrowPurple)" filter="url(#glow)"/>
  <circle cx="254" cy="238" r="16" fill="#a855f7"/>
  <text x="254" y="243" text-anchor="middle" fill="#fff" font-size="13" font-weight="700">1</text>

  <!-- Step 2: Attacker internal (intercept and read) - downward arrow -->
  <path d="M 390 375 L 390 430" fill="none" stroke="#ef4444" stroke-width="2.2" stroke-dasharray="6,3" marker-end="url(#arrowRed)"/>
  <circle cx="414" cy="402" r="16" fill="#ef4444"/>
  <text x="414" y="407" text-anchor="middle" fill="#fff" font-size="13" font-weight="700">2</text>

  <!-- Step 3: Attacker → Server (forward request) -->
  <path d="M 446 275 L 600 275" fill="none" stroke="#ef4444" stroke-width="2.2" stroke-dasharray="8,4" marker-end="url(#arrowRed)" filter="url(#glow)"/>
  <circle cx="524" cy="253" r="16" fill="#ef4444"/>
  <text x="524" y="258" text-anchor="middle" fill="#fff" font-size="13" font-weight="700">3</text>

  <!-- Step 4: Server → Attacker (response) -->
  <path d="M 604 300 L 446 300" fill="none" stroke="#3b82f6" stroke-width="2.2" stroke-dasharray="8,4" marker-end="url(#arrowBlue)"/>
  <circle cx="524" cy="320" r="16" fill="#3b82f6"/>
  <text x="524" y="325" text-anchor="middle" fill="#fff" font-size="13" font-weight="700">4</text>

  <!-- Step 5: Attacker → Victim (forwarded response, password stolen) -->
  <path d="M 334 295 L 176 295" fill="none" stroke="#ef4444" stroke-width="2.2" stroke-dasharray="8,4" marker-end="url(#arrowRed)" filter="url(#glow)"/>
  <circle cx="254" cy="316" r="16" fill="#ef4444"/>
  <text x="254" y="321" text-anchor="middle" fill="#fff" font-size="13" font-weight="700">5</text>

  <!-- ====================================================== -->
  <!--  Attacker intercept box                                -->
  <!-- ====================================================== -->
  <g transform="translate(390, 482)" filter="url(#shadow)">
    <rect x="-90" y="-28" width="180" height="84" rx="8" fill="#1e1b2e" stroke="#ef4444" stroke-width="1.2" stroke-dasharray="4,2"/>
    <rect x="-78" y="-20" width="156" height="13" rx="3" fill="#0f172a"/>
    <circle cx="-68" cy="-14" r="2.5" fill="#ef4444"/>
    <circle cx="-60" cy="-14" r="2.5" fill="#f59e0b"/>
    <circle cx="-52" cy="-14" r="2.5" fill="#22c55e"/>
    <text x="0" y="6" text-anchor="middle" fill="#fca5a5" font-size="10" font-weight="600">&#20621;&#21463;&#12375;&#12383;&#12487;&#12540;&#12479;</text>
    <text x="0" y="22" text-anchor="middle" fill="#94a3b8" font-size="8.5" font-family="'Fira Code', monospace">user=admin&amp;pass=secret</text>
    <text x="0" y="36" text-anchor="middle" fill="#ef4444" font-size="8.5">&#24179;&#25991;&#12391;&#35469;&#35388;&#24773;&#22577;&#12364;&#20024;&#35211;&#12360;</text>
    <text x="0" y="48" text-anchor="middle" fill="#94a3b8" font-size="8">Cookie: session_id=abc123...</text>
  </g>

  <!-- ===== Vulnerability callout ===== -->
  <g transform="translate(180, 430)" filter="url(#shadow)">
    <rect x="-110" y="-18" width="220" height="56" rx="8" fill="#451a03" stroke="#f97316" stroke-width="1"/>
    <text x="0" y="-1" text-anchor="middle" fill="#fdba74" font-size="11" font-weight="700">&#9888; &#26263;&#21495;&#21270;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;HTTP&#36890;&#20449;</text>
    <text x="0" y="16" text-anchor="middle" fill="#fb923c" font-size="9" font-family="'Fira Code', monospace">http://example.com/login</text>
    <text x="0" y="30" text-anchor="middle" fill="#fed7aa" font-size="8.5">(NOT https://)</text>
  </g>

  <!-- ===== HTTP plaintext code ===== -->
  <g transform="translate(390, 580)">
    <rect x="-210" y="-14" width="420" height="28" rx="5" fill="#0f172a" stroke="#334155" stroke-width="1"/>
    <text x="0" y="4" text-anchor="middle" fill="#94a3b8" font-size="9.5" font-family="'Fira Code', monospace">
      <tspan fill="#ef4444">POST</tspan><tspan fill="#93c5fd"> http://example.com/login</tspan><tspan fill="#fca5a5"> &#8594; Content-Type: application/x-www-form-urlencoded</tspan>
    </text>
  </g>

  <!-- ====================================================== -->
  <!--  STEP LIST (right sidebar)                              -->
  <!-- ====================================================== -->
  <g transform="translate(775, 100)">
    <rect x="0" y="0" width="305" height="360" rx="10" fill="#0f172a" stroke="#334155" stroke-width="1"/>
    <text x="152" y="28" text-anchor="middle" fill="#e2e8f0" font-size="14" font-weight="700">&#25915;&#25731;&#12473;&#12486;&#12483;&#12503;&#35443;&#32048;</text>
    <line x1="16" y1="40" x2="289" y2="40" stroke="#334155" stroke-width="1"/>

    <!-- Step 1 -->
    <circle cx="34" cy="68" r="13" fill="#a855f7"/>
    <text x="34" y="73" text-anchor="middle" fill="#fff" font-size="11" font-weight="700">1</text>
    <text x="56" y="64" fill="#f8fafc" font-size="11.5" font-weight="600">HTTP&#12391;&#12525;&#12464;&#12452;&#12531;&#24773;&#22577;&#12434;&#36865;&#20449;</text>
    <text x="56" y="80" fill="#94a3b8" font-size="9.5">&#34987;&#23475;&#32773;&#12364;&#26263;&#21495;&#21270;&#12394;&#12375;&#12391;</text>
    <text x="56" y="93" fill="#94a3b8" font-size="9.5">&#12497;&#12473;&#12527;&#12540;&#12489;&#12434;&#36865;&#20449;</text>

    <!-- Step 2 -->
    <circle cx="34" cy="124" r="13" fill="#ef4444"/>
    <text x="34" y="129" text-anchor="middle" fill="#fff" font-size="11" font-weight="700">2</text>
    <text x="56" y="120" fill="#f8fafc" font-size="11.5" font-weight="600">&#36890;&#20449;&#12434;&#20621;&#21463;&#12539;&#38322;&#35239;</text>
    <text x="56" y="136" fill="#94a3b8" font-size="9.5">&#25915;&#25731;&#32773;&#12364;&#24179;&#25991;&#12398;&#36890;&#20449;&#20869;&#23481;&#12434;</text>
    <text x="56" y="149" fill="#94a3b8" font-size="9.5">&#12497;&#12465;&#12483;&#12488;&#12473;&#12491;&#12501;&#12449;&#12391;&#35501;&#12415;&#21462;&#12427;</text>

    <!-- Step 3 -->
    <circle cx="34" cy="180" r="13" fill="#ef4444"/>
    <text x="34" y="185" text-anchor="middle" fill="#fff" font-size="11" font-weight="700">3</text>
    <text x="56" y="176" fill="#f8fafc" font-size="11.5" font-weight="600">&#12522;&#12463;&#12456;&#12473;&#12488;&#12434;&#12469;&#12540;&#12496;&#12540;&#12408;&#36578;&#36865;</text>
    <text x="56" y="192" fill="#94a3b8" font-size="9.5">&#25915;&#25731;&#32773;&#12364;&#21407;&#26412;&#12398;&#12522;&#12463;&#12456;&#12473;&#12488;&#12434;</text>
    <text x="56" y="205" fill="#94a3b8" font-size="9.5">&#12469;&#12540;&#12496;&#12540;&#12408;&#12381;&#12398;&#12414;&#12414;&#36578;&#36865;</text>

    <!-- Step 4 -->
    <circle cx="34" cy="236" r="13" fill="#3b82f6"/>
    <text x="34" y="241" text-anchor="middle" fill="#fff" font-size="11" font-weight="700">4</text>
    <text x="56" y="232" fill="#f8fafc" font-size="11.5" font-weight="600">&#12469;&#12540;&#12496;&#12540;&#12364;&#12524;&#12473;&#12509;&#12531;&#12473;&#12434;&#36820;&#12377;</text>
    <text x="56" y="248" fill="#94a3b8" font-size="9.5">&#12469;&#12540;&#12496;&#12540;&#12399;&#27491;&#24120;&#12394;&#36890;&#20449;&#12392;&#21028;&#26029;&#12375;</text>
    <text x="56" y="261" fill="#94a3b8" font-size="9.5">&#12524;&#12473;&#12509;&#12531;&#12473;&#12434;&#36820;&#21364;</text>

    <!-- Step 5 -->
    <circle cx="34" cy="292" r="13" fill="#ef4444"/>
    <text x="34" y="297" text-anchor="middle" fill="#fff" font-size="11" font-weight="700">5</text>
    <text x="56" y="288" fill="#f8fafc" font-size="11.5" font-weight="600">&#12497;&#12473;&#12527;&#12540;&#12489;&#12434;&#21462;&#24471;&#23436;&#20102;</text>
    <text x="56" y="304" fill="#94a3b8" font-size="9.5">&#25915;&#25731;&#32773;&#12364;&#35469;&#35388;&#24773;&#22577;&#12434;&#20445;&#25345;&#12375;&#12383;&#12414;&#12414;</text>
    <text x="56" y="317" fill="#94a3b8" font-size="9.5">&#12524;&#12473;&#12509;&#12531;&#12473;&#12434;&#34987;&#23475;&#32773;&#12395;&#36820;&#12377;</text>
    <text x="56" y="343" fill="#64748b" font-size="8.5">&#8251; &#34987;&#23475;&#32773;&#12399;&#20621;&#21463;&#12395;&#27671;&#12389;&#12363;&#12394;&#12356;</text>
  </g>

  <!-- ====================================================== -->
  <!--  ATTACK TECHNIQUE CARDS (bottom)                        -->
  <!-- ====================================================== -->
  <line x1="30" y1="630" x2="1070" y2="630" stroke="#334155" stroke-width="1"/>
  <text x="550" y="655" text-anchor="middle" fill="#fca5a5" font-size="14" font-weight="700">&#128293; &#20351;&#29992;&#12373;&#12428;&#12427;&#25915;&#25731;&#12486;&#12463;&#12491;&#12483;&#12463;</text>

  <!-- Card: Packet Sniffing -->
  <g transform="translate(165, 668)" filter="url(#shadow)">
    <rect x="-120" y="0" width="240" height="38" rx="8" fill="#1e1b2e" stroke="#ef4444" stroke-width="1"/>
    <rect x="-108" y="6" width="28" height="26" rx="5" fill="#ef4444" opacity="0.1"/>
    <g transform="translate(-94, 19)">
      <circle cx="0" cy="-3" r="6" fill="none" stroke="#ef4444" stroke-width="1.2"/>
      <path d="M4,1 L8,5" stroke="#ef4444" stroke-width="1.5" stroke-linecap="round"/>
    </g>
    <text x="10" y="16" text-anchor="middle" fill="#f8fafc" font-size="11" font-weight="600">&#12497;&#12465;&#12483;&#12488;&#12473;&#12491;&#12501;&#12449;&#12522;&#12531;&#12464;</text>
    <text x="10" y="30" text-anchor="middle" fill="#94a3b8" font-size="8.5">&#24179;&#25991;&#36890;&#20449;&#12398;&#20621;&#21463;</text>
  </g>

  <!-- Card: Wi-Fi Eavesdropping -->
  <g transform="translate(465, 668)" filter="url(#shadow)">
    <rect x="-120" y="0" width="240" height="38" rx="8" fill="#1e1b2e" stroke="#ef4444" stroke-width="1"/>
    <rect x="-108" y="6" width="28" height="26" rx="5" fill="#ef4444" opacity="0.1"/>
    <g transform="translate(-94, 19)">
      <path d="M-6,4 Q0,-8 6,4" fill="none" stroke="#ef4444" stroke-width="1.2"/>
      <path d="M-3,2 Q0,-3 3,2" fill="none" stroke="#ef4444" stroke-width="1.2"/>
      <circle cx="0" cy="3" r="1.5" fill="#ef4444"/>
    </g>
    <text x="10" y="16" text-anchor="middle" fill="#f8fafc" font-size="11" font-weight="600">Wi-Fi&#30423;&#32884;</text>
    <text x="10" y="30" text-anchor="middle" fill="#94a3b8" font-size="8.5">&#20844;&#34886;WiFi&#12391;&#12398;&#36890;&#20449;&#20621;&#21463;</text>
  </g>

  <!-- Card: Credential Theft -->
  <g transform="translate(765, 668)" filter="url(#shadow)">
    <rect x="-120" y="0" width="240" height="38" rx="8" fill="#1e1b2e" stroke="#ef4444" stroke-width="1"/>
    <rect x="-108" y="6" width="28" height="26" rx="5" fill="#ef4444" opacity="0.1"/>
    <g transform="translate(-94, 19)">
      <rect x="-7" y="-4" width="14" height="10" rx="2" fill="none" stroke="#ef4444" stroke-width="1.2"/>
      <path d="M-3,-4 L-3,-7 Q-3,-10 0,-10 Q3,-10 3,-7 L3,-4" fill="none" stroke="#ef4444" stroke-width="1.2"/>
      <circle cx="0" cy="1" r="1.5" fill="#ef4444"/>
    </g>
    <text x="10" y="16" text-anchor="middle" fill="#f8fafc" font-size="11" font-weight="600">&#35469;&#35388;&#24773;&#22577;&#31397;&#21462;</text>
    <text x="10" y="30" text-anchor="middle" fill="#94a3b8" font-size="8.5">&#12497;&#12473;&#12527;&#12540;&#12489;&#12539;&#12475;&#12483;&#12471;&#12519;&#12531;ID&#12398;&#21462;&#24471;</text>
  </g>

  <!-- ===== Legend ===== -->
  <g transform="translate(775, 490)">
    <rect x="0" y="0" width="305" height="86" rx="6" fill="#0f172a" stroke="#334155" stroke-width="1"/>
    <text x="14" y="18" fill="#94a3b8" font-size="10" font-weight="600">&#20961;&#20363;</text>
    <line x1="14" y1="34" x2="44" y2="34" stroke="#ef4444" stroke-width="2" stroke-dasharray="6,3"/>
    <text x="52" y="38" fill="#fca5a5" font-size="9.5">&#25915;&#25731;&#32773;&#12398;&#36890;&#20449;</text>
    <line x1="152" y1="34" x2="182" y2="34" stroke="#3b82f6" stroke-width="2"/>
    <text x="190" y="38" fill="#93c5fd" font-size="9.5">&#12469;&#12540;&#12496;&#12540;&#24540;&#31572;</text>
    <line x1="14" y1="54" x2="44" y2="54" stroke="#a855f7" stroke-width="2" stroke-dasharray="6,3"/>
    <text x="52" y="58" fill="#d8b4fe" font-size="9.5">&#34987;&#23475;&#32773;&#12398;&#36890;&#20449;</text>
    <line x1="152" y1="54" x2="182" y2="54" stroke="#64748b" stroke-width="1.5" stroke-dasharray="6,4"/>
    <text x="190" y="58" fill="#94a3b8" font-size="9.5">&#26412;&#26469;&#12398;&#30452;&#25509;&#36890;&#20449;</text>
    <rect x="14" y="66" width="12" height="12" rx="2" fill="#451a03" stroke="#f97316" stroke-width="0.8"/>
    <text x="32" y="76" fill="#fdba74" font-size="9.5">&#33030;&#24369;&#24615;&#12509;&#12452;&#12531;&#12488;</text>
  </g>

</svg>